<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Obsidian Server - How to Run</title>
    <!-- Twitter Card metadata -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="MCP Obsidian Server - How to Run">
    <meta name="twitter:description" content="Quick setup guide for running the MCP Obsidian server">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/OleksandrKucherenko/mcp-obsidian-via-rest/main/docs/obsidian-logo-bw.webp">
    <meta name="twitter:site" content="@OKucherenko">
    <!-- Simple CSS framework from CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css">
    <style>
        :root {
            --primary-color: #7e57c2;
        }
        body {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem;
        }
        header {
            margin-bottom: 2rem;
            text-align: center;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 1rem;
        }
        .badges {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 1rem 0;
        }
        .container {
            margin-bottom: 2rem;
        }
        img {
            max-width: 100%;
            display: block;
            margin: 1rem auto;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .step {
            margin-bottom: 1.5rem;
            padding: 1rem;
            border-left: 3px solid var(--primary-color);
            background-color: rgba(126, 87, 194, 0.05);
        }
        .note {
            background-color: rgba(54, 53, 45, 0.8);
            padding: 0.8rem;
            border-left: 3px solid #ffb74d;
            margin: 1rem 0;
        }
        footer {
            margin-top: 3rem;
            text-align: center;
            font-size: 0.9rem;
        }
        .rounded {
            border: none;
        }
        .screenshot-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }
        .screenshot-link:hover {
            text-decoration: underline;
        }
        .screenshot-date {
            color: #666;
            font-size: 0.9rem;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <header>
      <div class="logo">
        <img src="./obsidian-logo-bw.webp" alt="Obsidian Logo" width="120px" class="rounded">
      </div>
      <h1>MCP Obsidian Server</h1>
      <p>Quick setup guide for running the MCP Obsidian server</p>
      <div class="badges">
          <!-- 
            [![Publish NPM Package (npmjs.org)](
                https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-npmjs.yml/badge.svg
            )](https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-npmjs.yml)
          -->
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-npmjs.yml">
              <img src="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-npmjs.yml/badge.svg" alt="NPM">
          </a>
          <!-- 
            [![Publish NPM Package (GitHub)](
                https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-github.yml/badge.svg
            )](https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-github.yml)
          -->
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-github.yml">
              <img src="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/npm-github.yml/badge.svg" alt="NPM GitHub">
          </a>
          <!-- 
            [![Publish Docker Images (GitHub)](
                https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-github.yml/badge.svg
            )](https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-github.yml)
          -->
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-github.yml">
              <img src=" https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-github.yml/badge.svg" alt="Docker GitHub">
           </a>
          <!-- 
            [![Publish Docker Images (Docker Hub)](
                https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-hub.yml/badge.svg
            )](https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-hub.yml)
          -->
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-hub.yml" class="badge-link">
              <img src="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/actions/workflows/docker-hub.yml/badge.svg" alt="Docker (Docker Hub)">
          </a>
          <!-- Wiki -->
          <a href="https://deepwiki.com/OleksandrKucherenko/mcp-obsidian-via-rest" class="badge-link">
            <img src="https://deepwiki.com/badge.svg" alt="Ask DeepWiki">
          </a>
      </div>
    </header>

    <div class="container">
        <h2>Latest Screenshots</h2>
        <div class="step" id="screenshots-section">
            <p>Loading screenshots...</p>
        </div>
    </div>

    <div class="container">
        <h2>Step 1: Set Up Obsidian</h2>
        <div class="step">
            <p>Install and run <a href="https://obsidian.md/" target="_blank">Obsidian Desktop Application</a> and enable the <a href="https://github.com/coddingtonbear/obsidian-local-rest-api" target="_blank">Local REST API</a> plugin in Settings.</p>
            <p>Make sure to configure the API to listen on all interfaces (not just localhost), which is critical for WSL2 setup.</p>
            <img src="./obsidian-setup.jpg" alt="Obsidian Local REST API Setup">
            <p><strong>Important:</strong> Copy the API Key from Obsidian Settings, you'll need it for MCP configuration.</p>
        </div>

        <h2>Step 2: Configure MCP</h2>
        <div class="step">
            <p>Create or update your MCP configuration file with the following:</p>
            <pre><code class="language-json">{
  "mcpServers": {
    "obsidian": {
      "command": "docker",
      "args": [
        "run",
        "--name", "mcp-obsidian-windsurf", // optional
        "--interactive",
        "--rm",
        "-e", "API_KEY",
        "-e", "API_HOST",                  // optional
        "-e", "API_PORT",                  // optional
        "-e", "DEBUG",                     // optional
        "ghcr.io/oleksandrkucherenko/obsidian-mcp:latest"
      ],
      "env": {
        "API_KEY": "{secret_key}",         // required
        "API_HOST": "https://172.26.32.1", // default: https://localhost
        "API_PORT": "27124",               // default: 27124
        "DEBUG": "mcp:*"                   // default: disabled logs
      }
    } 
  }
}</code></pre>
            <div class="note">
                <p>Replace <code>{secret_key}</code> with the API Key you copied from Obsidian.</p>
                <p>For WSL2 users, use your Windows host IP as <code>API_HOST</code> (typically something like <code>172.26.32.1</code>).</p>
            </div>
        </div>

        <h2>Step 3: Verify REST API Connection</h2>
        <div class="step">
            <h3>On Windows:</h3>
            <pre><code class="language-bash"># Verify that the port is listening
netstat -an | findstr 27124 # Windows CMD

# Test the API connection
curl --insecure https://localhost:27124</code></pre>

            <h3>On WSL2 (Ubuntu):</h3>
            <pre><code class="language-bash"># Get Windows host IP
export WSL_GATEWAY_IP=$(ip route show | grep -i default | awk '{ print $3}')
echo $WSL_GATEWAY_IP

# Test the API connection
curl --insecure https://$WSL_GATEWAY_IP:27124</code></pre>

            <h3>On Linux:</h3>
            <pre><code class="language-bash"># check is port is listening
ss -tuln | grep ':27124'

# Test the API connection
wget --no-check-certificate -S https://localhost:27124</code></pre>

            <h3>On MacOS:</h3>
            <pre><code class="language-bash"># check is port is listening
sudo lsof -iTCP:27124 -sTCP:LISTEN

# Test the API connection (Httpie)
http --verify=no https://localhost:27124</code></pre>

            <p>Expected successful response:</p>
            <pre><code class="language-json">{
  "status": "OK",
  "manifest": {
    "id": "obsidian-local-rest-api",
    "name": "Local REST API",
    /* other manifest details... */
  },
  "service": "Obsidian Local REST API",
  "authenticated": false
}</code></pre>
        </div>

        <h2>Step 4: Check Firewall Settings (Windows)</h2>
        <div class="step">
            <p>Ensure your firewall allows connections on port 27124:</p>
            <pre><code class="language-powershell"># Add firewall rule (Run in Admin PowerShell)
New-NetFirewallRule -DisplayName "WSL2 Obsidian REST API" -Direction Inbound -LocalPort 27124 -Protocol TCP -Action Allow</code></pre>
        </div>

        <h2>Step 5: Run the MCP Server (without IDE)</h2>
        <div class="step">
            <p>You can now run the MCP server using Docker:</p>
            <pre><code class="language-bash">docker run --name mcp-obsidian-windsurf \
  --interactive \
  --rm \
  -e API_KEY="your-api-key" \
  -e API_HOST="https://your-host-ip" \
  -e API_PORT="27124" \
  -e DEBUG="mcp:*" \
  ghcr.io/oleksandrkucherenko/obsidian-mcp:latest</code></pre>
            <div class="note">
                <p>Docker arguments explained:</p>
                <ul>
                    <li><code>--rm</code> - Automatically remove the container when it exits</li>
                    <li><code>--interactive</code> - Keep STDIN open</li>
                    <li><code>-e, --env</code> - Set environment variables</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>Troubleshooting</h2>
        
        <h3>Connectivity Issues</h3>
        <div class="step">
            <p>To test connectivity from a Docker container:</p>
            <pre><code class="language-bash"># Get Windows host IP
export WSL_GATEWAY_IP=$(ip route show | grep -i default | awk '{ print $3}')
echo $WSL_GATEWAY_IP # expected something like: 172.26.32.1
                            
# Run a test container shell
docker run --rm -it --network=host busybox sh
</code></pre>
            <p>Inside the container shell:</p>
            <pre><code class="language-bash"># Inside the container shell 
export WINDOWS_HOST_IP="172.26.32.1"  # Replace with your host IP
wget -qO- --no-check-certificate "https://$WINDOWS_HOST_IP:27124"</code></pre>
        </div>

        <h3>Firewall Issues</h3>
        <div class="step">
            <p>To temporarily disable Windows Firewall for testing (not recommended for regular use):</p>
            <pre><code class="language-powershell"># Run in Admin PowerShell
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False

# Remember to re-enable after testing
Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled True</code></pre>
        </div>
    </div>

    <footer>
        <p>For more information, visit:</p>
        <p>
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest">GitHub Repository</a> |
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/tree/main/docs">More Documentation</a> |
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/pkgs/npm/mcp-obsidian">NPM Package Releases</a> |
          <a href="https://github.com/OleksandrKucherenko/mcp-obsidian-via-rest/pkgs/container/obsidian-mcp">Docker Image Releases</a>
        </p>
        <p class="version-info">Version: 0.5.2 | Commit: 92f7eb9</p>
    </footer>

    <!-- Scripts for syntax highlighting -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-powershell.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>

    <!-- Script to load and display screenshots -->
    <script>
        async function loadScreenshots() {
            const section = document.getElementById('screenshots-section');
            try {
                const response = await fetch('./screenshots.json');
                if (!response.ok) throw new Error('Failed to load screenshots');
                const data = await response.json();

                if (!data.screenshots || data.screenshots.length === 0) {
                    section.innerHTML = '<p>No screenshots available yet.</p>';
                    return;
                }

                const latest = data.screenshots[0];
                section.innerHTML = `
                    <p><a href="./${latest.id}/" class="screenshot-link">
                        <strong>ðŸ“¸ Latest Screenshots</strong> (Run #${latest.id})
                    </a></p>
                    <p class="screenshot-date">Last updated: ${new Date(latest.modified).toLocaleString()}</p>
                    <p><a href="./screenshots.json" class="screenshot-link">View all screenshots</a></p>
                `;
            } catch (error) {
                console.error('Error loading screenshots:', error);
                section.innerHTML = '<p>No screenshots available yet.</p>';
            }
        }

        // Load screenshots on page load
        document.addEventListener('DOMContentLoaded', loadScreenshots);
    </script>
</body>
</html>